<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>text-preprocessing</title><meta name=description content="felladog"><meta name=author content="Utsav Darlami"><link rel="shortcut icon" href=/blogs/img/21-512.png><link rel=stylesheet href=/blogs/css/style.css><link rel=stylesheet href=/blogs/css/syntax.css><link rel=stylesheet href=/blogs/css/toc.css><link rel=stylesheet href=/blogs/katex/katex.min.css><script defer src=/blogs/katex/katex.min.js></script>
<script defer src=/blogs/katex/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script></head><body><header></header><main><div class=toc><nav id=TableOfContents><ul><li><a href=#stemming>Stemming</a></li><li><a href=#code>Code</a><ul><li><a href=#remove-hyperlinks-twitter-marks-and-styles>Remove hyperlinks, Twitter marks and styles</a></li><li><a href=#tokenize-the-string>Tokenize the string</a></li><li><a href=#stop-words-and-punctuation>Stop words and punctuation</a></li><li><a href=#stemming>Stemming</a></li></ul></li></ul></nav><a href=# class=back-to-top>Back to top</a></div><script src=https://utsavdarlami.github.io/blogs/js/libs/jquery/3.3.1/jquery.slim.min.js></script>
<script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var n,o=t.scrollTop(),i=$(".body h1, .body h2, .body h3, .body h4, .body h5, .body h6"),s="";if(i.each(function(e,t){t=$(t),t.offset().top-10<=o&&(s=t.attr("id"))}),n=e.find("a.current"),n.length==1&&n.eq(0).attr("href")=="#"+s)return!0;n.each(function(e,t){$(t).removeClass("current").siblings("ul").hide()}),e.find('a[href="#'+s+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").addClass("current").siblings("ul").show()})}t.on("scroll",n),$(document).ready(function(){e.find("a").parent("li").find("ul").hide(),n(),document.getElementsByClassName("toc")[0].style.display=""})}})()</script><p align=right><a href=https://utsavdarlami.github.io/blogs/about>Me</a> |
<a href=https://utsavdarlami.github.io/blogs/>blogs</a> |
<a href=https://utsavdarlami.github.io/blogs/notes>notes</a> |
<a href=https://utsavdarlami.github.io/blogs/tags>tags</a> |
<a href=https://utsavdarlami.github.io/blogs/categories>categories</a> |
<a href=https://utsavdarlami.github.io/blogs/index.xml>feed</a> |
<a href=https://utsavdarlami.github.io/>home</a> |</p><article><h1>text-preprocessing</h1><div style=float:left><time>Created Date : 2021 March 31</time></div><br><div style=float:left><time>Last Modified : 2021 December 11</time></div><hr><div>tags:
<a href=/tags/bag-of-words>bag of words</a>
<a href=/tags/tf-idf>TF-IDF</a></div><div style=float:left>categories:
<a href=/categories/nlp>NLP</a>
<a href=/categories/data-preprocessing>data preprocessing</a></div><div><hr><ul><li>References :<ul><li>[Book] Builiding the ML systems with python</li><li><a href=http://tfidf.com/>http://tfidf.com/</a></li></ul></li><li>Questions :</li></ul><hr><p>Ways to preprocess text before <a href=/blogs/404.html>Feature Extraction in NLP</a></p><p>When preprocessing, we can perform the following:</p><ol><li>Eliminate handles and URLs</li><li>Tokenize the string into words.</li><li>Remove stop words like &ldquo;and, is, a, on, etc.&rdquo;</li><li><a href=#stemming>Stemming</a> or convert every word to its stem.<ul><li>Like dancer, dancing, danced, becomes &lsquo;danc&rsquo;. You can use porter stemmer to take care of this.</li></ul></li><li>Convert all your words to lower case.</li></ol><p>For example</p><ul><li><p>tweet</p><pre tabindex=0><code class=language-nil data-lang=nil>@YMourri and @AndrewYNg are tuning a GREAT AI model at https://deeplearning.ai!!!
</code></pre></li><li><p>After preprocessing becomes</p><pre tabindex=0><code class=language-nil data-lang=nil>[tun,great,ai,model]
</code></pre><p>Hence we can see how we eliminated handles, tokenized it into words, removed stop words, performed stemming, and converted everything to lower case.</p></li></ul><h2 id=stemming>Stemming</h2><p>Stemming is the process of converting a word to its most general form, or stem. This helps in reducing the size of our vocabulary.</p><p>Consider the words:</p><ul><li><strong>learn</strong></li><li><strong>learn</strong> ing</li><li><strong>learn</strong> ed</li><li><strong>learn</strong> t</li></ul><p>All these words are stemmed from its common root <strong>learn</strong>. However, in some cases, the stemming process produces words that are not correct spellings of the root word. For example, <strong>happi</strong> and <strong>sunni</strong>. That&rsquo;s because it chooses the most common stem for related words. For example, we can look at the set of words that comprises the different forms of happy:</p><ul><li><strong>happ</strong> y</li><li><strong>happi</strong> ness</li><li><strong>happi</strong> er</li></ul><p>We can see that the prefix <strong>happi</strong> is more commonly used. We cannot choose <strong>happ</strong> because it is the stem of unrelated words like <strong>happen</strong>.</p><p>NLTK has different modules for stemming and we will be using the <a href=https://www.nltk.org/api/nltk.stem.html#module-nltk.stem.porter>PorterStemmer</a> module which uses the <a href=https://tartarus.org/martin/PorterStemmer/>Porter Stemming Algorithm</a>. Let&rsquo;s see how we can use it in the cell below.</p><h2 id=code>Code</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>nltk</span>                                <span class=c1># Python library for NLP</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>nltk.corpus</span> <span class=kn>import</span> <span class=n>twitter_samples</span>    <span class=c1># sample Twitter dataset from NLTK</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>            <span class=c1># library for visualization</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span></code></pre></div><ul><li>Download stopwords from NLTK</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>nltk</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=s1>&#39;stopwords&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># download the stopwords from NLTK</span>
</span></span></code></pre></div><ul><li>Imports</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>                                  <span class=c1># library for regular expression operations</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>                              <span class=c1># for string operations</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>nltk.corpus</span> <span class=kn>import</span> <span class=n>stopwords</span>          <span class=c1># module for stop words that come with NLTK</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>nltk.stem</span> <span class=kn>import</span> <span class=n>PorterStemmer</span>        <span class=c1># module for stemming</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>nltk.tokenize</span> <span class=kn>import</span> <span class=n>TweetTokenizer</span>   <span class=c1># module for tokenizing strings</span>
</span></span></code></pre></div><h3 id=remove-hyperlinks-twitter-marks-and-styles>Remove hyperlinks, Twitter marks and styles</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>tweet2</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^RT[\s]+&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>tweet</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># remove hyperlinks</span>
</span></span><span class=line><span class=cl><span class=n>tweet2</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;https?://[^\s\n\r]+&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>tweet2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># remove hashtags</span>
</span></span><span class=line><span class=cl><span class=c1># only removing the hash # sign from the word</span>
</span></span><span class=line><span class=cl><span class=n>tweet2</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;#&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>tweet2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>tweet2</span><span class=p>)</span> <span class=c1>#</span>
</span></span></code></pre></div><h3 id=tokenize-the-string>Tokenize the string</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># instantiate tokenizer class</span>
</span></span><span class=line><span class=cl><span class=n>tokenizer</span> <span class=o>=</span> <span class=n>TweetTokenizer</span><span class=p>(</span><span class=n>preserve_case</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>strip_handles</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			       <span class=n>reduce_len</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># tokenize tweets</span>
</span></span><span class=line><span class=cl><span class=n>tweet_tokens</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>tokenize</span><span class=p>(</span><span class=n>tweet2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Tokenized string:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>tweet_tokens</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=stop-words-and-punctuation>Stop words and punctuation</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Import the english stop words list from NLTK</span>
</span></span><span class=line><span class=cl><span class=n>stopwords_english</span> <span class=o>=</span> <span class=n>stopwords</span><span class=o>.</span><span class=n>words</span><span class=p>(</span><span class=s1>&#39;english&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Stop words</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>stopwords_english</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Punctuation</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>punctuation</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>Removing stop words and punctuation</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>tweets_clean</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>tweet_tokens</span><span class=p>:</span> <span class=c1># Go through every word in your tokens list</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>word</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>stopwords_english</span> <span class=ow>and</span>  <span class=c1># remove stopwords</span>
</span></span><span class=line><span class=cl>	<span class=n>word</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>string</span><span class=o>.</span><span class=n>punctuation</span><span class=p>):</span>  <span class=c1># remove punctuation</span>
</span></span><span class=line><span class=cl>	<span class=n>tweets_clean</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;removed stop words and punctuation:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>tweets_clean</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=stemming>Stemming</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Instantiate stemming class</span>
</span></span><span class=line><span class=cl><span class=n>stemmer</span> <span class=o>=</span> <span class=n>PorterStemmer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create an empty list to store the stems</span>
</span></span><span class=line><span class=cl><span class=n>tweets_stem</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>tweets_clean</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>stem_word</span> <span class=o>=</span> <span class=n>stemmer</span><span class=o>.</span><span class=n>stem</span><span class=p>(</span><span class=n>word</span><span class=p>)</span>  <span class=c1># stemming word</span>
</span></span><span class=line><span class=cl>    <span class=n>tweets_stem</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>stem_word</span><span class=p>)</span>  <span class=c1># append to the list</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;stemmed words:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>tweets_stem</span><span class=p>)</span>
</span></span></code></pre></div></div><p style=font-size:1.65em;text-align:center><a href=/blogs/notes/2021-03-06--03-56-06z--entropy/>&#8678;</a>
<a href=/blogs/notes/2021-05-22--10-42-02z--activation_function/>&#8680;</a></p><hr><hr><footer><main><h3>Comments</h3><script src=https://utteranc.es/client.js repo=utsavdarlami/blogs issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></main></footer></article></main><footer></footer></body></html>